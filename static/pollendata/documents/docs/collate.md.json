{"attributes":{"backlinks":[{"tag":"document","title":"DataLoaders.jl","docid":"documents/README.md"},{"tag":"documentation","title":"DataLoader","docid":"references/DataLoaders.DataLoader"},{"tag":"documentation","title":"collate","docid":"references/DataLoaders.collate"}],"path":"/home/lorenz/.julia/dev/DataLoaders/docs/collate.md","title":"Collating"},"tag":"document","children":[{"attributes":{},"tag":"h1","children":[{"mimes":{"text/plain":"Collating"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Collating refers to combining a batch of observations so that the arrays in individual observations are stacked together"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" As an example, consider a dataset with 100 observations, each with 2 features"}},{"mimes":{"text/plain":"."}}]},{"attributes":{"result":"false","class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"result":"false","class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"rand"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"100"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")  # observation dimension is last by default"}}]}]}]}]}]},{"mimes":{"text/plain":""}},{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"We can collect a batch of 4 observations into a vector as follows:"}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_using","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"using"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders"},"tag":"reference","children":[{"mimes":{"text/plain":"DataLoaders"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n"}}]}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_comprehension","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_generator","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"getobs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"for"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"in "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":":"}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"4"}}]}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"4-element Vector{Vector{Float64}}:\n [0.9500959966782806, 0.427279201141208]\n [0.11017811050845794, 0.32435580264393793]\n [0.7336665603757899, 0.5091559054706456]\n [0.01615778094551057, 0.0473023013465923]"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Many machine learning models, however, expect an input in a "}},{"attributes":{},"tag":"em","children":[{"mimes":{"text/plain":"collated"}}]},{"mimes":{"text/plain":" format: instead of a nested vector of vectors, we need a single ND"}},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"array"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" DataLoaders"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl provides the "}},{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders.collate"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"collate"}}]}]},{"mimes":{"text/plain":" function for this:"}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders"},"tag":"reference","children":[{"mimes":{"text/plain":"DataLoaders"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders.collate"},"tag":"reference","children":[{"mimes":{"text/plain":"collate"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"2Ã—4 Matrix{Float64}:\n 0.950096  0.110178  0.733667  0.0161578\n 0.427279  0.324356  0.509156  0.0473023"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"As you can see, the batch dimension is the last one by default"}},{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"h2","children":[{"mimes":{"text/plain":"Nested observations"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"The above case only shows how to collate observations that each consist of a single array"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" In practice, however, observations will often consist of multiple variables like input features and a target variable"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" For example, we could have an integer indicating the class of an input sample"}},{"mimes":{"text/plain":"."}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"inputs"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"rand"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"2"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"100"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"targets"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"rand"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":":"}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"10"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"100"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_tuple","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"inputs"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"targets"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_comprehension","children":[{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"["}}]},{"attributes":{},"tag":"CST_generator","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"getobs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"data"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"for"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"i"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"in "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"1"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":":"}}]},{"attributes":{},"tag":"CST_INTEGER","children":[{"mimes":{"text/plain":"4"}}]}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"]"}}]}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"4-element Vector{Tuple{Vector{Float64}, Int64}}:\n ([0.6944723913323388, 0.1726764431446236], 10)\n ([0.761775493833758, 0.1676272779912732], 4)\n ([0.15463234396615277, 0.6497678861881766], 5)\n ([0.6999367687959651, 0.5054084343159738], 2)"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Collating here also works, by keeping the tuple structure and collating each element separately:"}}]},{"attributes":{"class":"cellcontainer","cell":"main","lang":"julia"},"tag":"div","children":[{"attributes":{"class":"codecell","cell":"main","lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders"},"tag":"reference","children":[{"mimes":{"text/plain":"DataLoaders"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataLoaders.collate"},"tag":"reference","children":[{"mimes":{"text/plain":"collate"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"batch"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]},{"mimes":{"text/plain":""}},{"attributes":{"class":"coderesult"},"tag":"pre","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"([0.6944723913323388 0.761775493833758 0.15463234396615277 0.6999367687959651; 0.1726764431446236 0.1676272779912732 0.6497678861881766 0.5054084343159738], [10, 4, 5, 2])"}}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"This is also implemented for "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"NamedTuple"}}]},{"mimes":{"text/plain":"s and "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Dict"}}]},{"mimes":{"text/plain":"s"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" You can also collate nested structures, e"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"g"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" a "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Tuple"}}]},{"mimes":{"text/plain":" of "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Dict"}}]},{"mimes":{"text/plain":"s and the structure is preserved"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" This also works when using "}},{"attributes":{"reftype":"document","href":"inplaceloading.md","title":"","document_id":"documents/docs/inplaceloading.md"},"tag":"reference","children":[{"mimes":{"text/plain":"inplace loading"}}]},{"mimes":{"text/plain":"."}}]}]}