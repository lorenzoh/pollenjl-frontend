{"attributes":{"backlinks":[{"tag":"document","title":"toc","docid":"documents/toc.md"}],"path":"/home/lorenz/.julia/dev/DataAugmentation/docs/literate/buffering.md","title":"Buffering"},"tag":"document","children":[{"attributes":{},"tag":"h1","children":[{"mimes":{"text/plain":"Buffering"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"As mentioned in the section on "}},{"attributes":{"reftype":"document","href":"./tfminterface.md","title":"","document_id":"documents/docs/literate/tfminterface.md"},"tag":"reference","children":[{"mimes":{"text/plain":"transformations"}}]},{"mimes":{"text/plain":", you can implement "}},{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply!"}}]}]},{"mimes":{"text/plain":" as an inplace version of "}},{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply"}}]}]},{"mimes":{"text/plain":" to support buffered transformations"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" Usually, the result of a regular "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply"}}]},{"mimes":{"text/plain":" can be used as a buffer"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" You may write"}}]},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"buffer "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply"},"tag":"reference","children":[{"mimes":{"text/plain":"apply"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"tfm"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"item"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply!"},"tag":"reference","children":[{"mimes":{"text/plain":"apply!"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"buffer"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"tfm"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"item"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"However, for some transformations, a different buffer is needed"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" "}},{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.Sequence"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Sequence"}}]}]},{"mimes":{"text/plain":", for example, needs to reuse all intermediate results"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" That is why the buffer creation can be customized:"}}]},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.makebuffer"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"makebuffer"}}]}]},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"(tfm, item)"}}]},{"mimes":{"text/plain":" creates a buffer "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"buf"}}]},{"mimes":{"text/plain":" that can be used in an "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply!"}}]},{"mimes":{"text/plain":" call: "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply!(buf, tfm, item)"}}]},{"mimes":{"text/plain":"."}}]}]}]},{"attributes":{},"tag":"hr","children":[]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Managing the buffers manually quickly becomes tedious"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" For convenience, this library implements "}},{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.Buffered"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Buffered"}}]}]},{"mimes":{"text/plain":", a transformation wrapper that will use a buffer internally"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"btfm = Buffered(tfm)"}}]},{"mimes":{"text/plain":" will create a buffer the first time it is "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply"}}]},{"mimes":{"text/plain":"ed and then use it by internally calling "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"apply!"}}]},{"mimes":{"text/plain":"."}}]},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"buffered "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.Buffered"},"tag":"reference","children":[{"mimes":{"text/plain":"Buffered"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"tfm"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"buffer "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.apply"},"tag":"reference","children":[{"mimes":{"text/plain":"apply"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"tfm"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"item"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")  # uses apply! internally"}}]}]}]}]}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"Since "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Buffered"}}]},{"mimes":{"text/plain":" only stores one buffer, you may run into problems when using it in a multi"}},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"threading context where different threads invalidate the buffer before it can be used"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" In that case, you can use "}},{"attributes":{"reftype":"symbol","document_id":"references/DataAugmentation.BufferedThreadsafe"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"BufferedThreadsafe"}}]}]},{"mimes":{"text/plain":", a version of "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"Buffered"}}]},{"mimes":{"text/plain":" that keeps a separate buffer for every thread"}},{"mimes":{"text/plain":"."}}]}]}